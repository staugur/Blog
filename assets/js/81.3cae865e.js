(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{561:function(s,a,n){"use strict";n.r(a);var e=n(4),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("适用于以*.access.log开头的访问日志。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#!/bin/bash\n#This script run at 00:00.\nlogs_path="/data/app/nginx/logs"\n#切分后log存放的目录\nbak_path="/data/logs"\n\nyesterday=$(date -d "yesterday" +"%Y%m%d")\nnginx_pid=$(cat ${logs_path}/nginx.pid)\nhost=$(ls -l ${logs_path}/*.access.log | awk -F " " \'{print $9}\' | awk -F ".access" \'{print $1}\' | awk -F "$logs_path/" \'{print $2}\')\nfor i in $host\ndo\n  program=${bak_path}/$i\n  bakfile=${program}/${yesterday}.tgz\n  [ -d $program ] || mkdir -p $program\n  if [ -f $bakfile ];then\n    echo "已存在备份文件";exit 1\n  else\n    mv ${logs_path}/${i}.access.log $program;\n    cd $program ; tar zcf $bakfile ${i}.access.log --remove\n  fi\ndone\n[ -d ${bak_path}/all ] || mkdir -p ${bak_path}/all\ncd ${bak_path}/all\nmv ${logs_path}/access.log . && tar zcf ${yesterday}.access.tgz access.log --remove\nmv ${logs_path}/error.log . && tar zcf ${yesterday}.error.tar.gz error.log --remove\n\n#向nginx主进程发信号重新打开日志\nkill -USR1 $nginx_pid\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);