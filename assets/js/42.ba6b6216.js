(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{524:function(t,a,s){"use strict";s.r(a);var e=s(4),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"前文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前文"}},[t._v("#")]),t._v(" "),s("strong",[t._v("前文")])]),t._v(" "),s("blockquote",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("在使用Api场景的系统交互时，​使用API签名，即保证请求的数据正确性和接口安全，又能识别API调用者的身份。 \n")])])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("以下以一种常见方式演示：\n\n    公共参数加请求参数排序后，再加上密钥，最后使用诸如md5、hmac等加密生成signature值，作为请求参数。\n\n这种签名方式：\n\n    牵一发而动全身，公共参数包含时间戳参数亦可防止拦截URL多次请求，包含accesskey\\_id以识别调用者，较有通用性。\n\n更多介绍参考：\n\n    简书：<http://www.jianshu.com/p/d47da77b6419>\n\n    阿里云：<https://help.aliyun.com/document_detail/54229.html>\n")])])]),s("h3",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" "),s("strong",[t._v("示例")])]),t._v(" "),s("h5",{attrs:{id:"github-flask-apisign-demo-https-github-com-staugur-flask-apisign-demo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github-flask-apisign-demo-https-github-com-staugur-flask-apisign-demo"}},[t._v("#")]),t._v(" GitHub flask-apiSign-demo："),s("a",{attrs:{href:"https://github.com/staugur/flask-apiSign-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/staugur/flask-apiSign-demo"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("p",[s("code",[t._v("cd server;pip install \\-r requirements.txt")]),s("br"),t._v(" "),s("code",[t._v("python main.py")])]),t._v(" "),s("h4",{attrs:{id:"客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[t._v("#")]),t._v(" 客户端")]),t._v(" "),s("h5",{attrs:{id:"python、shell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python、shell"}},[t._v("#")]),t._v(" Python、Shell")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.saintic.com/EauDouce/blog/201806061955117008.png",alt:"1"}})]),t._v(" "),s("h5",{attrs:{id:"javascript-html"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript-html"}},[t._v("#")]),t._v(" JavaScript(HTML)")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.saintic.com/EauDouce/blog/201806061955204291.png",alt:"2"}})]),t._v(" "),s("h4",{attrs:{id:"签名描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#签名描述"}},[t._v("#")]),t._v(" 签名描述")]),t._v(" "),s("h5",{attrs:{id:"一、起因"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、起因"}},[t._v("#")]),t._v(" 一、起因")]),t._v(" "),s("p",[t._v("为了实现基本的防抓取机制，对绝大多数采用了 Api 签名验证，在保证签名秘钥不泄露的前提下，具有一定的数据抓取防御能力。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("请求参数是否被篡改；")])]),t._v(" "),s("li",[s("p",[t._v("请求来源是否合法；")])]),t._v(" "),s("li",[s("p",[t._v("请求是否具有唯一性。")])])]),t._v(" "),s("h5",{attrs:{id:"二、经过"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、经过"}},[t._v("#")]),t._v(" 二、经过")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("前提准备")]),t._v(" "),s("p",[t._v("接口提供方生成用户密钥，包含：")]),t._v(" "),s("p",[t._v("1.1 accesskey_id, 标识用户")]),t._v(" "),s("p",[t._v("1.2 accesskey_secret, 用户加密串(严格保管，仅用于加密不参与通信)")])]),t._v(" "),s("li",[s("p",[t._v("公共参数")]),t._v(" "),s("p",[t._v("2.1 accesskey_id, 标识用户")]),t._v(" "),s("p",[t._v("2.2 version, 后端接口版本号")]),t._v(" "),s("p",[t._v("2.3 timestamp, 10位时间戳(客户端生成时间戳可以适当减几秒)")]),t._v(" "),s("p",[t._v("2.4 signature, uri请求参数签名(除signature外所有)")]),t._v(" "),s("h1",{attrs:{id:"另可以定义其他参数-比如signmethod"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#另可以定义其他参数-比如signmethod"}},[t._v("#")]),t._v(" 另可以定义其他参数，比如signMethod")])]),t._v(" "),s("li",[s("p",[t._v("签名过程")]),t._v(" "),s("p",[t._v("3.1.对除签名外的所有请求参数按key做的升序排列。")]),t._v(" "),s("p",[s("code",[t._v("例如：有b=2一个私有参数，另加上公共参数后，按key排序后为：accesskey_id、b、timestamp、version")])]),t._v(" "),s("p",[t._v('3.2 把排序后的参数以"参数名=参数值&"的形式连接，末尾再加上"accesskey_secret"值，得到拼装字符串。')]),t._v(" "),s("p",[s("code",[t._v("例如：accesskey_id=test&b=2×tamp=1511232761&version=v1&accesskey_secret")])]),t._v(" "),s("p",[t._v("3.3 将上一步得到的字符串MD5加密并转化为大写。")]),t._v(" "),s("p",[s("code",[t._v("例如：signature=F833B331E572FD9D3D64A8D0737490B0")])]),t._v(" "),s("p",[t._v("3.4 最终请求示例。")]),t._v(" "),s("p",[s("code",[t._v("timestamp=1511232761&b=2&version=v1&accesskey_id=test&signature=F833B331E572FD9D3D64A8D0737490B0")])])]),t._v(" "),s("li",[s("p",[t._v("验证请求：")]),t._v(" "),s("p",[t._v("4.1 验证版本(非必要)")]),t._v(" "),s("p",[t._v("4.2 验证时间戳是否有效(小于等于服务器时间戳且在30s之内请求有效)")]),t._v(" "),s("p",[t._v("4.3 验证accesskey_id是否有效")]),t._v(" "),s("p",[t._v("4.4 验证签名")])])]),t._v(" "),s("h4",{attrs:{id:"四、参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、参考"}},[t._v("#")]),t._v(" 四、参考")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"http://www.hello1010.com/api-sign",target:"_blank",rel:"noopener noreferrer"}},[t._v("API接口签名验证(详细描述主流签名方式)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/Eliacy/YYMiOS/wiki/Api%EF%BC%9A%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("Api：签名验证机制(提及关于POST签名说明)"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);