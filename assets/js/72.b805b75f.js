(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{552:function(t,i,o){"use strict";o.r(i);var s=o(4),a=Object(s.a)({},(function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("p",[o("section",{staticStyle:{"font-size":"16px",padding:"0 10px","word-spacing":"0px","word-break":"break-word","word-wrap":"break-word","text-align":"left","line-height":"1.25",color:"#2b2b2b","font-family":"Optima-Regular, Optima, PingFangTC-Light, PingFangSC-light, PingFangTC-light","letter-spacing":"2px","background-image":"linear-gradient(90deg, rgba(50, 0, 0, 0.04) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.04) 3%, rgba(0, 0, 0, 0) 3%)","background-size":"20px 20px","background-position":"center center"},attrs:{id:"nice","data-tool":"mdnice编辑器","data-website":"https://www.mdnice.com"}},[o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("Isso是一个使用Python和JavaScript编写的轻量级的开源评论系统，它旨在成为Disqus的替代产品。")]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("其特点：")]),t._v(" "),o("ul",{staticStyle:{"margin-top":"8px","margin-bottom":"8px","padding-left":"25px","font-size":"15px",color:"#595959","list-style-type":"circle"},attrs:{"data-tool":"mdnice编辑器"}},[o("li",[o("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"}},[t._v("使用 Markdown 评论")])])]),o("li",[o("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"}},[t._v("SQLite 后端")])])]),o("li",[o("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"}},[t._v("Disqus & WordPress 导入")])])]),o("li",[o("section",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","line-height":"26px","text-align":"left","font-size":"14px","font-weight":"normal",color:"#595959"}},[o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"}},[t._v("可配置的 JS 客户端，支持 Firefox, Safari, Chrome 和 IE10。")])])])]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("我之前写了"),o("a",{staticStyle:{"text-decoration":"none","word-wrap":"break-word",color:"#40B8FA","font-weight":"normal","border-bottom":"1px solid #3BAAFA"},attrs:{href:"https://blog.saintic.com/blog/275.html"}},[t._v("Isso的文章")]),t._v("，包括部署过程记录、使用经验总结，以及我fork的isso-cn版本，此版本主要增加了微信审核的功能，鉴于一些情况，现将微信审核部分代码单独拎出来，这样“按图索骥”，可以实现原isso微信审核功能。")]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("以下细节可以参考我的"),o("a",{staticStyle:{"text-decoration":"none","word-wrap":"break-word",color:"#40B8FA","font-weight":"normal","border-bottom":"1px solid #3BAAFA"},attrs:{href:"https://github.com/staugur/isso-cn/commit/17e7fe4dc8a969c6af80729aa87b663d0351e4bd"}},[t._v("这个commit")]),t._v("实现。")]),t._v(" "),o("h3",{staticStyle:{padding:"0px",color:"black","font-size":"17px","font-weight":"bold","text-align":"center",position:"relative","margin-top":"20px","margin-bottom":"20px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid RGBA(79, 177, 249, .65)",color:"#2b2b2b","padding-bottom":"2px"}},[o("span",{staticStyle:{width:"30px",height:"30px",display:"block","background-image":"url(https://files.mdnice.com/fullstack-2.png)","background-position":"center","background-size":"30px",margin:"auto",opacity:"1","background-repeat":"no-repeat","margin-bottom":"-8px"}}),t._v("前言")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("下载isso，可以用git克隆master最新代码，或者直接下载某个发行版，当然建议直接用pip安装。")]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("注意：从源码安装还是挺复杂，需要构建静态资源。")]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("不过本文这不是重点，可以查阅"),o("a",{staticStyle:{"text-decoration":"none","word-wrap":"break-word",color:"#40B8FA","font-weight":"normal","border-bottom":"1px solid #3BAAFA"},attrs:{href:"https://isso-cn.rtfd.vip"}},[t._v("中文文档")]),t._v("或Google...")]),t._v(" "),o("h3",{staticStyle:{padding:"0px",color:"black","font-size":"17px","font-weight":"bold","text-align":"center",position:"relative","margin-top":"20px","margin-bottom":"20px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid RGBA(79, 177, 249, .65)",color:"#2b2b2b","padding-bottom":"2px"}},[o("span",{staticStyle:{width:"30px",height:"30px",display:"block","background-image":"url(https://files.mdnice.com/fullstack-2.png)","background-position":"center","background-size":"30px",margin:"auto",opacity:"1","background-repeat":"no-repeat","margin-bottom":"-8px"}}),t._v("NO.1 修改isso/__init__.py文件")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("h4",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"18px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{height:"16px","line-height":"16px","font-size":"16px"}},[o("span",{staticStyle:{"background-image":"url(https://files.mdnice.com/fullstack-3.png)",display:"inline-block",width:"16px",height:"15px","background-size":"100%","background-position":"left bottom","background-repeat":"no-repeat","line-height":"15px","margin-right":"6px","margin-bottom":"-2px"}}),t._v("1. 大概 75L")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#3594F7",background:"RGBA(59, 170, 250, .1)",padding:"0 2px","border-radius":"2px",height:"21px","line-height":"22px"}},[t._v("from isso.ext.notifications import Stdout, SMTP")])]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("改为")]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[o("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#3594F7",background:"RGBA(59, 170, 250, .1)",padding:"0 2px","border-radius":"2px",height:"21px","line-height":"22px"}},[t._v("from isso.ext.notifications import Stdout, SMTP, Wechat")])]),t._v(" "),o("h4",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"18px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{height:"16px","line-height":"16px","font-size":"16px"}},[o("span",{staticStyle:{"background-image":"url(https://files.mdnice.com/fullstack-3.png)",display:"inline-block",width:"16px",height:"15px","background-size":"100%","background-position":"left bottom","background-repeat":"no-repeat","line-height":"15px","margin-right":"6px","margin-bottom":"-2px"}}),t._v("2. 大概 114L")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("在")]),t._v(" "),o("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticStyle:{display:"block",background:"url(https://files.mdnice.com/point.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#f8f8f8","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),o("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#333",display:"-webkit-box","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","letter-spacing":"0px","padding-top":"15px",background:"#f8f8f8","border-radius":"5px"}},[o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("elif")]),t._v(" backend "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("in")]),t._v(" ("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"smtp"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"SMTP"')]),t._v("):"),o("br"),t._v("    smtp_backend = True"),o("br")])]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("后面添加")]),t._v(" "),o("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticStyle:{display:"block",background:"url(https://files.mdnice.com/point.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#f8f8f8","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),o("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#333",display:"-webkit-box","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","letter-spacing":"0px","padding-top":"15px",background:"#f8f8f8","border-radius":"5px"}},[o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("elif")]),t._v(" backend "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("in")]),t._v(" ("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"wechat"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"WECHAT"')]),t._v("):"),o("br"),t._v("    subscribers.append(Wechat(self))"),o("br")])]),t._v(" "),o("h3",{staticStyle:{padding:"0px",color:"black","font-size":"17px","font-weight":"bold","text-align":"center",position:"relative","margin-top":"20px","margin-bottom":"20px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid RGBA(79, 177, 249, .65)",color:"#2b2b2b","padding-bottom":"2px"}},[o("span",{staticStyle:{width:"30px",height:"30px",display:"block","background-image":"url(https://files.mdnice.com/fullstack-2.png)","background-position":"center","background-size":"30px",margin:"auto",opacity:"1","background-repeat":"no-repeat","margin-bottom":"-8px"}}),t._v("NO.2 修改isso/ext/notifications.py文件")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("h4",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"18px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{height:"16px","line-height":"16px","font-size":"16px"}},[o("span",{staticStyle:{"background-image":"url(https://files.mdnice.com/fullstack-3.png)",display:"inline-block",width:"16px",height:"15px","background-size":"100%","background-position":"left bottom","background-repeat":"no-repeat","line-height":"15px","margin-right":"6px","margin-bottom":"-2px"}}),t._v("1. 大概 32L")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("添加 "),o("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#3594F7",background:"RGBA(59, 170, 250, .1)",padding:"0 2px","border-radius":"2px",height:"21px","line-height":"22px"}},[t._v("from isso.utils.http import curl")])]),t._v(" "),o("h4",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"18px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{height:"16px","line-height":"16px","font-size":"16px"}},[o("span",{staticStyle:{"background-image":"url(https://files.mdnice.com/fullstack-3.png)",display:"inline-block",width:"16px",height:"15px","background-size":"100%","background-position":"left bottom","background-repeat":"no-repeat","line-height":"15px","margin-right":"6px","margin-bottom":"-2px"}}),t._v("2. 大概 34L")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("原本"),o("code",{staticStyle:{"font-size":"14px","word-wrap":"break-word",margin:"0 2px","background-color":"rgba(27,31,35,.05)","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","word-break":"break-all",color:"#3594F7",background:"RGBA(59, 170, 250, .1)",padding:"0 2px","border-radius":"2px",height:"21px","line-height":"22px"}},[t._v("if PY2K")]),t._v("更改如下：")]),t._v(" "),o("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticStyle:{display:"block",background:"url(https://files.mdnice.com/point.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#f8f8f8","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),o("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#333",display:"-webkit-box","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","letter-spacing":"0px","padding-top":"15px",background:"#f8f8f8","border-radius":"5px"}},[o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" PY2K:"),o("br"),t._v("    from thread import start_new_thread"),o("br"),t._v("    from urllib import urlencode"),o("br"),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("else")]),t._v(":"),o("br"),t._v("    from _thread import start_new_thread"),o("br"),t._v("    from urllib.parse import urlencode"),o("br")])]),t._v(" "),o("h4",{staticStyle:{"margin-top":"30px","margin-bottom":"15px",padding:"0px","font-weight":"bold",color:"black","font-size":"18px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{height:"16px","line-height":"16px","font-size":"16px"}},[o("span",{staticStyle:{"background-image":"url(https://files.mdnice.com/fullstack-3.png)",display:"inline-block",width:"16px",height:"15px","background-size":"100%","background-position":"left bottom","background-repeat":"no-repeat","line-height":"15px","margin-right":"6px","margin-bottom":"-2px"}}),t._v("3. 在末尾增加Wechat审核类")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("以下内容也许非最新，建议查看"),o("a",{staticStyle:{"text-decoration":"none","word-wrap":"break-word",color:"#40B8FA","font-weight":"normal","border-bottom":"1px solid #3BAAFA"},attrs:{href:"https://github.com/staugur/isso-cn/blob/master/isso/ext/notifications.py#L247"}},[t._v("这个文件")])]),t._v(" "),o("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticStyle:{display:"block",background:"url(https://files.mdnice.com/point.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#f8f8f8","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),o("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#333",display:"-webkit-box","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","letter-spacing":"0px","padding-top":"15px",background:"#f8f8f8","border-radius":"5px"}},[t._v("class Wechat(object):"),o("br"),o("br"),t._v("    def __init__(self, isso):"),o("br"),o("br"),t._v("        self.isso = isso"),o("br"),t._v("        self.conf = isso.conf.section("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"wechat"')]),t._v(")"),o("br"),t._v("        self.public_endpoint = isso.conf.get("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"server"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"public-endpoint"')]),t._v(") or "),o("span",{staticClass:"hljs-built_in",staticStyle:{color:"#0086b3","line-height":"26px"}},[t._v("local")]),t._v("("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"host"')]),t._v(")"),o("br"),t._v("        self.admin_notify = any((n "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("in")]),t._v(" ("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"wechat"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"WECHAT"')]),t._v(")) "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("for")]),t._v(" n "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("in")]),t._v(" isso.conf.getlist("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"general"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"notify"')]),t._v("))"),o("br"),t._v("        self.moderated = isso.conf.getboolean("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"moderation"')]),t._v(", "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"enabled"')]),t._v(")"),o("br"),o("br"),t._v("    def __iter__(self):"),o("br"),t._v("        yield "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"comments.new:after-save"')]),t._v(", self.notify_new"),o("br"),o("br"),t._v("    def format(self, thread, comment):"),o("br"),o("br"),t._v("        md = []"),o("br"),o("br"),t._v("        author = comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"author"')]),t._v("] or "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"Anonymous"')]),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"email"')]),t._v("]:"),o("br"),t._v("            author += "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('" <%s>"')]),t._v(" % comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"email"')]),t._v("]"),o("br"),o("br"),t._v("        md.append(author + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('" wrote:\\n"')]),t._v(")"),o("br"),t._v("        md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"\\n"')]),t._v(")"),o("br"),t._v("        md.append(comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"text"')]),t._v("] + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"\\n"')]),t._v(")"),o("br"),t._v("        md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"\\n"')]),t._v(")"),o("br"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"website"')]),t._v("]:"),o("br"),t._v("            md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"User\'s URL: %s\\n"')]),t._v(" % comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"website"')]),t._v("])"),o("br"),t._v("        md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"IP address: %s\\n"')]),t._v(" % comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"remote_addr"')]),t._v("])"),o("br"),o("br"),t._v("        view_uri = "),o("span",{staticClass:"hljs-built_in",staticStyle:{color:"#0086b3","line-height":"26px"}},[t._v("local")]),t._v("("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"origin"')]),t._v(") + thread["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"uri"')]),t._v("] + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"#isso-%i"')]),t._v(" % comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"id"')]),t._v("]"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" not self.moderated:"),o("br"),t._v("            md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"Link to comment: %s\\n"')]),t._v(" % view_uri)"),o("br"),t._v("            md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"\\n"')]),t._v(")"),o("br"),t._v("            md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"---\\n"')]),t._v(")"),o("br"),o("br"),t._v("        uri = self.public_endpoint + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"/id/%i"')]),t._v(" % comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"id"')]),t._v("]"),o("br"),t._v("        key = self.isso.sign(comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"id"')]),t._v("])"),o("br"),t._v("        delete_uri = uri + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"/delete/"')]),t._v(" + key"),o("br"),t._v("        activate_uri = uri + "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"/activate/"')]),t._v(" + key"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" not self.moderated:"),o("br"),t._v("            md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"Delete comment: %s\\n"')]),t._v(" % delete_uri)"),o("br"),t._v("            "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" comment["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"mode"')]),t._v("] == 2:"),o("br"),t._v("                md.append("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"Activate comment: %s\\n"')]),t._v(" % activate_uri)"),o("br"),o("br"),t._v("        rv = "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"\\n"')]),t._v(".join(md)"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" self.moderated:"),o("br"),t._v("            "),o("span",{staticClass:"hljs-built_in",staticStyle:{color:"#0086b3","line-height":"26px"}},[t._v("return")]),t._v(" dict(rv=rv, v=view_uri, d=delete_uri, a=activate_uri)"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("else")]),t._v(":"),o("br"),t._v("            "),o("span",{staticClass:"hljs-built_in",staticStyle:{color:"#0086b3","line-height":"26px"}},[t._v("return")]),t._v(" rv"),o("br"),o("br"),t._v("    def notify_new(self, thread, comment):"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" self.admin_notify:"),o("br"),t._v("            body = self.format(thread, comment)"),o("br"),t._v("            self.sendmsg(thread["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"title"')]),t._v("], body)"),o("br"),o("br"),t._v("    def sendmsg(self, title, body):"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" self.moderated:"),o("br"),t._v("            TA_view = body["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"v"')]),t._v("]"),o("br"),t._v("            TA_delete = body["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"d"')]),t._v("]"),o("br"),t._v("            TA_activate = body["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"a"')]),t._v("]"),o("br"),t._v("            body = body["),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"rv"')]),t._v("]"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" PY2K:"),o("br"),t._v("            "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" title:"),o("br"),t._v("                title = title.encode("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"utf-8"')]),t._v(")"),o("br"),t._v("            body = body.encode("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"utf-8"')]),t._v(")"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" self.moderated:"),o("br"),t._v("            "),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# Need to review comments, use the TalkAdmin interface.")]),o("br"),t._v("            host = "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"http://sc.ftqq.com"')]),o("br"),t._v("            path = "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"/webhook/%s?%s"')]),t._v(" % (self.conf.get("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"takey"')]),t._v("), urlencode(dict("),o("br"),t._v("                TA_action_on=1,"),o("br"),t._v("                TA_title=title,"),o("br"),t._v("                TA_content=body,"),o("br"),t._v("                TA_view=TA_view,"),o("br"),t._v("                TA_delete=TA_delete,"),o("br"),t._v("                TA_activate=TA_activate"),o("br"),t._v("            )))"),o("br"),t._v("        "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("else")]),t._v(":"),o("br"),t._v("            host = "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"https://sc.ftqq.com"')]),o("br"),t._v("            path = "),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"/%s.send?%s"')]),t._v(" % (self.conf.get("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"sckey"')]),t._v("), urlencode(dict("),o("br"),t._v("                text=title, desp=body"),o("br"),t._v("            )))"),o("br"),t._v("        with curl("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"POST"')]),t._v(", host, path, 5) as resp:"),o("br"),t._v("            "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" resp:"),o("br"),t._v("                try:"),o("br"),t._v("                    result = json.loads(resp.read())"),o("br"),t._v("                except (TypeError, ValueError):"),o("br"),t._v("                    logger.error("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"Illegal response structure, request error."')]),t._v(")"),o("br"),t._v("                "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("else")]),t._v(":"),o("br"),t._v("                    "),o("span",{staticClass:"hljs-keyword",staticStyle:{color:"#333","font-weight":"bold","line-height":"26px"}},[t._v("if")]),t._v(" result.get("),o("span",{staticClass:"hljs-string",staticStyle:{color:"#d14","line-height":"26px"}},[t._v('"errno"')]),t._v(") != 0:"),o("br"),t._v("                        logger.warn(result)"),o("br")])]),t._v(" "),o("h3",{staticStyle:{padding:"0px",color:"black","font-size":"17px","font-weight":"bold","text-align":"center",position:"relative","margin-top":"20px","margin-bottom":"20px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid RGBA(79, 177, 249, .65)",color:"#2b2b2b","padding-bottom":"2px"}},[o("span",{staticStyle:{width:"30px",height:"30px",display:"block","background-image":"url(https://files.mdnice.com/fullstack-2.png)","background-position":"center","background-size":"30px",margin:"auto",opacity:"1","background-repeat":"no-repeat","margin-bottom":"-8px"}}),t._v("NO.3 修改share/isso.conf文件")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("在末尾添加")]),t._v(" "),o("pre",{staticClass:"custom",staticStyle:{"margin-top":"10px","margin-bottom":"10px","border-radius":"5px","box-shadow":"rgba(0, 0, 0, 0.55) 0px 2px 10px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticStyle:{display:"block",background:"url(https://files.mdnice.com/point.png)",height:"30px",width:"100%","background-size":"40px","background-repeat":"no-repeat","background-color":"#f8f8f8","margin-bottom":"-7px","border-radius":"5px","background-position":"10px 10px"}}),o("code",{staticClass:"hljs",staticStyle:{"overflow-x":"auto",padding:"16px",color:"#333",display:"-webkit-box","font-family":"Operator Mono, Consolas, Monaco, Menlo, monospace","font-size":"12px","-webkit-overflow-scrolling":"touch","letter-spacing":"0px","padding-top":"15px",background:"#f8f8f8","border-radius":"5px"}},[t._v("[wechat]"),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# Isso can notify you on new comments via wechat. In the wechat notification,")]),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# you also can moderate (=activate or delete) comments.")]),o("br"),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# ServerChan api credentials (similar to token).")]),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# Enabled when moderation is not enabled.")]),o("br"),t._v("sckey ="),o("br"),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# TalkAdmin WebHook Key.")]),o("br"),o("span",{staticClass:"hljs-comment",staticStyle:{color:"#998","font-style":"italic","line-height":"26px"}},[t._v("# Enabled when moderation is enabled.")]),o("br"),t._v("takey ="),o("br")])]),t._v(" "),o("p",{staticStyle:{"padding-top":"8px","padding-bottom":"8px","line-height":"26px",color:"#2b2b2b",margin:"10px 0px","letter-spacing":"2px","font-size":"14px","word-spacing":"2px"},attrs:{"data-tool":"mdnice编辑器"}},[t._v("这是微信审核所需要的配置信息，根据模式不同，选填sckey或takey，参考"),o("a",{staticStyle:{"text-decoration":"none","word-wrap":"break-word",color:"#40B8FA","font-weight":"normal","border-bottom":"1px solid #3BAAFA"},attrs:{href:"https://isso-cn.rtfd.vip/zh_CN/latest/docs/configuration/server/#wechat"}},[t._v("Wechat文档")])]),t._v(" "),o("h3",{staticStyle:{padding:"0px",color:"black","font-size":"17px","font-weight":"bold","text-align":"center",position:"relative","margin-top":"20px","margin-bottom":"20px"},attrs:{"data-tool":"mdnice编辑器"}},[o("span",{staticClass:"prefix",staticStyle:{display:"none"}}),o("span",{staticClass:"content",staticStyle:{"border-bottom":"2px solid RGBA(79, 177, 249, .65)",color:"#2b2b2b","padding-bottom":"2px"}},[o("span",{staticStyle:{width:"30px",height:"30px",display:"block","background-image":"url(https://files.mdnice.com/fullstack-2.png)","background-position":"center","background-size":"30px",margin:"auto",opacity:"1","background-repeat":"no-repeat","margin-bottom":"-8px"}}),t._v("END")]),o("span",{staticClass:"suffix",staticStyle:{display:"none"}})])])])])}),[],!1,null,null,null);i.default=a.exports}}]);