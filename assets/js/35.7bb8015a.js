(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{515:function(s,n,a){"use strict";a.r(n);var e=a(4),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("flask版本0.10.1")]),s._v(" "),a("p",[s._v("经测试，可以下载含有中文文件，预览txt、sh、py等(需自定义)文本文件，其他类型直接下载。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# -*- coding: utf-8 -*-\n\n\nimport os.path\nfrom flask import Flask, request, make_response, send_from_directory\n\napp = Flask(__name__)\n\n@app.route("/download/")\ndef download():\n    """ 下载附件、预览文本文件\n    :catalog(str):  下载分类(子)目录，比如attachment、script\n    :filename(str): 下载的实际文件(不需要目录，目录由catalog指定)，包含扩展名\n    """\n    # 下载文件存放目录\n    directory = os.path.join(os.path.dirname(os.path.abspath(__file__)), "download")\n    # 下载分类(directory的子目录)\n    catalog = request.args.get("catalog")\n    # 下载文件名\n    filename = request.args.get("filename")\n    app.logger.debug("Want to download a file with catalog: {0}, filename: {1}".format(catalog, filename))\n    if catalog and filename:\n        if filename.split(".")[-1] in ("txt", "sh", "py", "php"):\n            headers = ("Content-Type", "text/plain;charset=utf-8;")\n            as_attachment = False\n        else:\n            headers = ("Content-Disposition", "attachment;filename={}".format(filename))\n            as_attachment = True\n        if os.path.isfile(os.path.join(directory, catalog, filename)):\n            response = make_response(send_from_directory(directory=os.path.join(directory, catalog), filename=filename, as_attachment=as_attachment))\n            response.headers[headers[0]] = headers[1]\n        else:\n            response = make_response("Not Found File")\n    else:\n        response = make_response("Invalid Download Request")\n    return response\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);