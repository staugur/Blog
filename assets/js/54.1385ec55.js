(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{351:function(s,e,a){"use strict";a.r(e);var t=a(0),i=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("一、Python封装的使用zip压缩文件的代码(修正版)：")]),a("p",[s._v("说明：这个函数只是针对性地压缩一个目录下所有文件，若使用，你可能需要再修改。")]),a("p",[s._v("作用：压缩目录并返回压缩文件路径。")]),a("p",[s._v("参数：")]),a("p",[s._v("    zip_filename str: 压缩文件名，包含后缀.zip")]),a("p",[s._v("    zip_path str: 压缩目录，程序要能探查到目录，比如可以用绝对路径；或者相对路径，但是要切换到同目录下")]),a("p",[s._v("    exclude list: 依据后缀要排除的文件，参考使用中的例子")]),a("p",[s._v("使用：")]),a("p",[s._v('    zipfilepath = make_zipfile("test.zip", "testdir", [".zip", ".lock"])')]),a("p",[s._v("    以上代码运行的当前目录存在testdir目录，将会逐一压缩testdir目录下的文件，文件后缀包含.zip、.lock的将不压缩。")]),a("p",[s._v("代码：")]),a("pre",{staticStyle:{"max-width":"100%"}},[a("code",{staticClass:"python hljs",attrs:{codemark:"1"}},[a("span",{staticClass:"hljs-function"},[a("span",{staticClass:"hljs-keyword"},[s._v("def")]),s._v(" "),a("span",{staticClass:"hljs-title"},[s._v("make_zipfile")]),a("span",{staticClass:"hljs-params"},[s._v("(zip_filename, zip_path, exclude=[])")]),s._v(":")]),s._v("\n    "),a("span",{staticClass:"hljs-string"},[s._v('"""Create a zipped file with the name zip_filename. Compress the files in the zip_path directory. Do not include subdirectories. Exclude files in the exclude file.\n    @param zip_filename str: Compressed file name\n    @param zip_path str: The compressed directory (the files in this directory will be compressed)\n    @param exclude list,tuple: File suffixes will not be compressed in this list when compressed\n    """')]),s._v("\n    "),a("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" zip_filename "),a("span",{staticClass:"hljs-keyword"},[s._v("and")]),s._v(" os.path.splitext(zip_filename)["),a("span",{staticClass:"hljs-number"},[s._v("-1")]),s._v("] == "),a("span",{staticClass:"hljs-string"},[s._v('".zip"')]),s._v(" "),a("span",{staticClass:"hljs-keyword"},[s._v("and")]),s._v(" zip_path "),a("span",{staticClass:"hljs-keyword"},[s._v("and")]),s._v(" os.path.isdir(zip_path) "),a("span",{staticClass:"hljs-keyword"},[s._v("and")]),s._v(" isinstance(exclude, (list, tuple)):\n        "),a("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(":\n            "),a("span",{staticClass:"hljs-keyword"},[s._v("import")]),s._v(" zipfile\n        "),a("span",{staticClass:"hljs-keyword"},[s._v("except")]),s._v(" ImportError:\n            "),a("span",{staticClass:"hljs-keyword"},[s._v("raise")]),s._v("\n        "),a("span",{staticClass:"hljs-keyword"},[s._v("with")]),s._v(" zipfile.ZipFile(zip_filename, "),a("span",{staticClass:"hljs-string"},[s._v('"w"')]),s._v(", compression=zipfile.ZIP_DEFLATED, allowZip64="),a("span",{staticClass:"hljs-keyword"},[s._v("True")]),s._v(") "),a("span",{staticClass:"hljs-keyword"},[s._v("as")]),s._v(" zf:\n            "),a("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" filename "),a("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" os.listdir(zip_path):\n                "),a("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" os.path.isdir(filename):\n                    "),a("span",{staticClass:"hljs-keyword"},[s._v("continue")]),s._v("\n                "),a("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" "),a("span",{staticClass:"hljs-keyword"},[s._v("not")]),s._v(" os.path.splitext(filename)["),a("span",{staticClass:"hljs-number"},[s._v("-1")]),s._v("] "),a("span",{staticClass:"hljs-keyword"},[s._v("in")]),s._v(" exclude:\n                    zf.write(os.path.join(zip_path, filename), filename)\n        "),a("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" zip_filename "),a("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" os.path.isabs(zip_filename) "),a("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" os.path.join(os.getcwd(), zip_filename)\n    "),a("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(":\n        "),a("span",{staticClass:"hljs-keyword"},[s._v("raise")]),s._v(" TypeError\n")])]),a("p",[s._v("二、遇到的问题："),a("br")]),a("p",[s._v("1. LargeZipFile: Zipfile size would require ZIP64 extensions")]),a("p",[s._v("答：参加上述代码，allowZip64=True在这个问题发生时是没有的，由于压缩容量过大，发生异常，此时需要允许zip64，这个参数默认是False，改为True可以压缩成过大文件。")]),s._v(" "),a("Ads"),s._v(" "),a("Utterances")],1)}),[],!1,null,null,null);e.default=i.exports}}]);